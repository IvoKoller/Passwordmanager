'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _templateObject = _taggedTemplateLiteral(['', ''], ['', '']),
    _templateObject2 = _taggedTemplateLiteral(['\n\t\tanimationName: ', ';\n\t\tanimationDuration: ', 'ms;\n  \tanimationIterationCount: ', ';\n\t\tdisplay: \'inline-block\';\n\t\ttransformOrigin: ', ';\n\t\t\n\t\t&', ' {\n\t\t\tanimationName: ', ';\n\t\t\tanimationPlayState: ', ';\n\t\t\tanimation: ', ';\n\t\t}\n\t\t\n\t\tanimationPlayState: ', ';\n\t'], ['\n\t\tanimationName: ', ';\n\t\tanimationDuration: ', 'ms;\n  \tanimationIterationCount: ', ';\n\t\tdisplay: \'inline-block\';\n\t\ttransformOrigin: ', ';\n\t\t\n\t\t&', ' {\n\t\t\tanimationName: ', ';\n\t\t\tanimationPlayState: ', ';\n\t\t\tanimation: ', ';\n\t\t}\n\t\t\n\t\tanimationPlayState: ', ';\n\t']);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _styledComponents = require('styled-components');

var _styledComponents2 = _interopRequireDefault(_styledComponents);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

var Shake = function Shake(_ref) {
	var _ref$h = _ref.h;
	var h = _ref$h === undefined ? 5 : _ref$h;
	var _ref$v = _ref.v;
	var v = _ref$v === undefined ? 5 : _ref$v;
	var _ref$r = _ref.r;
	var r = _ref$r === undefined ? 3 : _ref$r;
	var _ref$dur = _ref.dur;
	var dur = _ref$dur === undefined ? 300 : _ref$dur;
	var _ref$q = _ref.q;
	var q = _ref$q === undefined ? 'infinite' : _ref$q;
	var _ref$tf = _ref.tf;
	var tf = _ref$tf === undefined ? 'ease-in-out' : _ref$tf;
	var _ref$int = _ref.int;
	var int = _ref$int === undefined ? 10 : _ref$int;
	var _ref$max = _ref.max;
	var max = _ref$max === undefined ? 100 : _ref$max;
	var _ref$orig = _ref.orig;
	var orig = _ref$orig === undefined ? 'center center' : _ref$orig;
	var _ref$fixed = _ref.fixed;
	var fixed = _ref$fixed === undefined ? false : _ref$fixed;
	var _ref$freez = _ref.freez;
	var freez = _ref$freez === undefined ? false : _ref$freez;
	var _ref$active = _ref.active;
	var active = _ref$active === undefined ? true : _ref$active;
	var _ref$trigger = _ref.trigger;
	var trigger = _ref$trigger === undefined ? ':hover' : _ref$trigger;
	var _ref$fixedStop = _ref.fixedStop;
	var fixedStop = _ref$fixedStop === undefined ? false : _ref$fixedStop;
	var _ref$elem = _ref.elem;
	var elem = _ref$elem === undefined ? 'div' : _ref$elem;

	var props = _objectWithoutProperties(_ref, ['h', 'v', 'r', 'dur', 'q', 'tf', 'int', 'max', 'orig', 'fixed', 'freez', 'active', 'trigger', 'fixedStop', 'elem']);

	var random = function random(max) {
		var min = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

		return Math.random() * (max - min) - max / 2;
	};

	var doKeyframes = function doKeyframes() {
		// el objecto que iremos llenando
		var kf = {};
		var init = 'translate(0,0) rotate(0)';

		// loop con intervalos basados en `int`
		for (var st = int; st <= max; st += int) {
			// Numeros aleatorios en cada keyframe
			var x = random(h);
			var y = random(v);
			var rot = random(r);

			kf[st + '%'] = {
				transform: 'translate(' + x + 'px, ' + y + 'px) rotate(' + rot + 'deg)'
			};
		}

		// Init de las transformaciones en 0% y 100%
		kf['0%'] = kf['100%'] = {
			transform: init
		};

		// Init tambiÃ©n en caso el `max` < 100
		if (max < 100) {
			kf[max + '%'] = {
				transform: init
			};
		}

		return kf;
	};

	// Creamos los `@keyframes`
	var kf = doKeyframes();

	var toString = function toString(obj) {
		return Object.keys(obj).reduce(function (acc, next) {
			return acc + '\n\t\t\t' + next + ' {\n\t\t\t\ttransform: ' + obj[next].transform + '\n\t\t\t}';
		}, '');
	};

	var shakeKeyframes = (0, _styledComponents.keyframes)(_templateObject, toString(doKeyframes()));

	var shouldShakeDefault = fixed || !fixed && freez;
	var shouldShakeWhenTriggered = !fixed && !freez;

	var ShakeComp = _styledComponents2.default[elem](_templateObject2, shouldShakeDefault && shakeKeyframes, dur, q, orig, trigger, shouldShakeWhenTriggered && shakeKeyframes, freez && (!fixed ? 'running' : 'paused'), fixed && fixedStop && 'initial', freez && (!fixed ? 'paused' : 'running'));

	return _react2.default.createElement(
		ShakeComp,
		props,
		props.children
	);
};

exports.default = Shake;